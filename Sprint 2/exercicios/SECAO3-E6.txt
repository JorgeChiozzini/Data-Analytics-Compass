WITH QuantidadePublicacoes AS (
    SELECT
        aut.codautor,
        aut.nome,
        COUNT(liv.autor) AS quantidade_publicacoes
    FROM
        autor AS aut
    LEFT JOIN
        livro AS liv ON aut.codautor = liv.autor
    GROUP BY
        aut.codautor, aut.nome
)

SELECT
    codautor,
    nome,
    quantidade_publicacoes
FROM
    QuantidadePublicacoes
WHERE
    quantidade_publicacoes = (
        SELECT MAX(quantidade_publicacoes)
        FROM QuantidadePublicacoes
    )


|codautor|nome             |quantidade_publicacoes|
|--------|-----------------|----------------------|
|67      |BARP, Wilson Jos√©|7                     |
