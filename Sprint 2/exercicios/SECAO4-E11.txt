WITH GastoPorCliente AS (
    SELECT
        cdcli,
        nmcli,
        SUM(qtd * vrunt) AS gasto
    FROM
        tbvendas
    WHERE
        status = 'Conclu√≠do'
    GROUP BY
        cdcli, nmcli
)

SELECT
    cdcli,
    nmcli,
    gasto
FROM
    GastoPorCliente
WHERE
    gasto = (SELECT MAX(gasto) FROM GastoPorCliente)


|cdcli|nmcli      |gasto    |
|-----|-----------|---------|
|9    |Cliente BCA|1.237.250|
