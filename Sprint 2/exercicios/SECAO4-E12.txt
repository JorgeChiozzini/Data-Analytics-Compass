
WITH ValorTotalVendasPorDependente AS (
    SELECT
        depe.cddep,
        depe.nmdep,
        depe.dtnasc,
        SUM(venda.qtd * venda.vrunt) AS valor_total_vendas
    FROM
        tbdependente AS depe
    JOIN
        tbvendedor AS vende ON vende.cdvdd = depe.cdvdd
    JOIN
        tbvendas AS venda ON vende.cdvdd = venda.cdvdd
    WHERE
        status = 'Conclu√≠do'
    GROUP BY
        depe.cddep, depe.nmdep, depe.dtnasc
)

SELECT
    cddep,
    nmdep,
    dtnasc,
    valor_total_vendas
FROM
    ValorTotalVendasPorDependente
WHERE
    valor_total_vendas = (SELECT MIN(valor_total_vendas) FROM ValorTotalVendasPorDependente)



|cddep|nmdep       |dtnasc             |valor_total_vendas|
|-----|------------|-------------------|------------------|
|6    |Dependente 6|2018-03-02 00:00:00|39.100            |
