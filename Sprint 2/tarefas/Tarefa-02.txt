SELECT ed.codeditora as CodEditora , ed.nome as NomeEditora , COUNT(liv.editora) as QuantidadeLivros 
from livro as liv
left join editora as ed
on liv.editora = ed.codeditora 
left join endereco as en
on ed.endereco = en.codendereco 
group by editora 
order by COUNT(liv.editora) desc LIMIT 5