'''
A coluna #1 Movie contém o filme de maior bilheteria em que o ator 
atuou. Realize a contagem de aparições destes filmes no dataset, 
listando-os ordenados pela quantidade de vezes em que estão 
presentes. Considere a ordem decrescente e, em segundo nível, o 
nome do  filme. Ao escrever no arquivo, considere o padrão de 
saída <sequencia> - O filme <nome filme> aparece <quantidade> 
vez(es) no dataset, adicionando um resultado a cada linha.
'''


# Contar aparições dos filmes de maior bilheteria
with open('actors.csv', 'r') as file:
    lines = file.readlines()

# Remover o cabeçalho
header = lines[0]
lines = lines[1:]

# Criar um dicionário para contar as aparições
contagem_filmes = {}
for line in lines:
    filme = line.split(',')[4]
    contagem_filmes[filme] = contagem_filmes.get(filme, 0) + 1

# Ordenar o dicionário pela quantidade de aparições
contagem_ordenada = sorted(contagem_filmes.items(), key=lambda x: (-x[1], x[0]))

# Imprimir o resultado
for i, (filme, quantidade) in enumerate(contagem_ordenada, start=1):
    print(f"{i} - O filme '{filme.strip()}' aparece {quantidade} vez(es) no dataset.")
