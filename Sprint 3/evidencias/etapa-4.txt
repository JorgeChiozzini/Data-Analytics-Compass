'''
A coluna #1 Movie contém o filme de maior bilheteria em que o ator 
atuou. Realize a contagem de aparições destes filmes no dataset, 
listando-os ordenados pela quantidade de vezes em que estão 
presentes. Considere a ordem decrescente e, em segundo nível, o 
nome do  filme. Ao escrever no arquivo, considere o padrão de 
saída <sequencia> - O filme <nome filme> aparece <quantidade> 
vez(es) no dataset, adicionando um resultado a cada linha.
'''


with open('actors.csv', 'r') as file:
    lines = file.readlines()    

header = lines[0]
lines = lines[1:]

movies = [line.split(',')[4] for line in lines]

movies_count = {}

for movie in movies:
    if movie in movies_count:
        movies_count[movie] += 1
    else:
        movies_count[movie] = 1

movies_count = sorted(movies_count.items(), key=lambda x: (-x[1], x[0]))

for index, (movie, count) in enumerate(movies_count):
  print(f"{index} - O filme {movie} aparece {count} vez(es) no dataset")



with open('movies_count.txt', 'w') as file:
    for index, (movie, count) in enumerate(movies_count):
        file.write(f"{index} - O filme {movie} aparece {count} vez(es) no dataset\n")